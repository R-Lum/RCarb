<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model dose rate evolution in carbonate-rich samples — model_DoseRate • RCarb</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model dose rate evolution in carbonate-rich samples — model_DoseRate"><meta name="description" content="This function models the dose rate evolution in carbonate enrich environments. For the
calculation internal functions are called."><meta property="og:description" content="This function models the dose rate evolution in carbonate enrich environments. For the
calculation internal functions are called."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RCarb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/GetStarted.html">Get started with RCarb</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/RCarb/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model dose rate evolution in carbonate-rich samples</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/RCarb/blob/HEAD/R/model_DoseRate.R" class="external-link"><code>R/model_DoseRate.R</code></a></small>
      <div class="d-none name"><code>model_DoseRate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function models the dose rate evolution in carbonate enrich environments. For the
calculation internal functions are called.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">model_DoseRate</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  DR_conv_factors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  length_step <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  max_time <span class="op">=</span> <span class="fl">500L</span>,</span>
<span>  n.MC <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  method_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  txtProgressBar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  par_local <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>): input data following the structure given
in the example data set <code>data(Example_Data)</code>. The input <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> should have at least
one row (i.e. values for one sample). For multiple rows the function is automatically re-called.</p></dd>


<dt id="arg-dr-conv-factors">DR_conv_factors<a class="anchor" aria-label="anchor" href="#arg-dr-conv-factors"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>optional</em>): applied dose rate conversion factors,
allowed input values are <code>"Carb2007"</code>, <code>"Adamiec_Aitken_1998"</code>, <code>"Guerin_et_al_2011"</code>,
<code>"Liritzis_et_al_2013"</code>. <code>NULL</code> triggers the default, which is <code>"Carb2007"</code></p></dd>


<dt id="arg-length-step">length_step<a class="anchor" aria-label="anchor" href="#arg-length-step"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (with default): step length used for the calculation</p></dd>


<dt id="arg-max-time">max_time<a class="anchor" aria-label="anchor" href="#arg-max-time"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (with default): maximum temporal search range</p></dd>


<dt id="arg-n-mc">n.MC<a class="anchor" aria-label="anchor" href="#arg-n-mc"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (with default): number of Monte Carlo runs used for the error calculation</p></dd>


<dt id="arg-method-control">method_control<a class="anchor" aria-label="anchor" href="#arg-method-control"></a></dt>
<dd><p>(<em>optional</em>): additional arguments that can be provided to the control the
the modelling. See details for further information.</p></dd>


<dt id="arg-txtprogressbar">txtProgressBar<a class="anchor" aria-label="anchor" href="#arg-txtprogressbar"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (with default): enables/disables the <code>txtProgressBar</code> for the MC runs</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (with default): enables/disables verbose mode</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (with default): enables/disables plot output</p></dd>


<dt id="arg-par-local">par_local<a class="anchor" aria-label="anchor" href="#arg-par-local"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (with default): enables/disable local par settings, If set
to <code>FALSE</code> all global par settings are accepted.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed to the underlying plot functions, see also details for further information. Supported standard arguments are <code>mfrow</code>, <code>xlim</code>, <code>xlab</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns numerical and graphical output</p>
<p>———————————–<br><code>[ NUMERICAL OUTPUT ]</code><br>
———————————–<br></p><ul><li><p>A <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> which is the combination of the input and values calculated by this function.</p></li>
</ul><p>———————————–<br><code>[ GRAPHICAL OUTPUT ]</code><br>
———————————–<br></p>
<p><strong>Upper plot:</strong> Dose rate evolution over time backwards. The solid black line is the calculation
output, the grey shaded area indicates the 2-sigma error margins. The dashed blue line is an indicator
of the quality of the error estimations based on Monte Carlo (MC) runs.The closer it follows the
black line, the more reliable are the given error margins. <br></p>
<p><strong>Lower plot:</strong> Totally absorbed dose over time. The plot is an representation of the 'new'
age based on the carbonate modelling.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is the starting point for the dose rate modelling for carbonate enrich
environments. It provides basically the same functionality as the original version of <code>'Carb'</code>, i.e.
you should be also aware of the limitations of this modelling approach. In particular: The model
assumes a linear carbonate mass increase due to post-depositional processes. Please read the
references cited blow.<br></p>
<p><strong>Uncertainty estimation</strong></p>
<p>For estimating the uncertainties, Monte-Carlo (MC) simulation runs are used. For very
small values (close to 0) this can, however, lead to edge effects (similar in <code>'Carb'</code>) since
values below 0 are set to 0.</p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.2.1</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mauz, B., Hoffmann, D., 2014. What to do when carbonate replaced water: Carb, the model for estimating the
dose rate of carbonate-rich samples. Ancient TL 32, 24-32. <a href="http://ancienttl.org/ATL_32-2_2014/ATL_32-2_Mauz_p24-32.pdf" class="external-link">http://ancienttl.org/ATL_32-2_2014/ATL_32-2_Mauz_p24-32.pdf</a></p>
<p>Nathan, R.P., Mauz, B., 2008. On the dose-rate estimate of carbonate-rich sediments for trapped charge dating.
Radiation Measurements 43, 14-25. <a href="https://doi.org/10.1016/j.radmeas.2007.12.012" class="external-link">doi:10.1016/j.radmeas.2007.12.012</a>
 <br></p>
<p><strong>Further reading</strong></p>
<p>Nathan, R.P., 2010. Numerical modelling of environmental dose rate and its application to trapped-charge dating.
DPhil thesis, St Hugh's College, Oxford. <a href="https://ora.ox.ac.uk/objects/ora:6421" class="external-link">https://ora.ox.ac.uk/objects/ora:6421</a></p>
<p>Zimmerman, D.W., 1971. Thermoluminescent dating using fine grains from pottery.
Archaeometry 13, 29–52.<a href="https://doi.org/10.1111/j.1475-4754.1971.tb00028.x" class="external-link">doi:10.1111/j.1475-4754.1971.tb00028.x</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany); based
on 'MATLAB' code given in file Carb_2007a.m of <em>Carb</em></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##load example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Example_Data"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##run the function for one sample from</span></span></span>
<span class="r-in"><span><span class="co">##the dataset</span></span></span>
<span class="r-in"><span><span class="fu">model_DoseRate</span><span class="op">(</span></span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">Example_Data</span><span class="op">[</span><span class="fl">14</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>n.MC <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>txtProgressBar <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [model_DoseRate()]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sample ID:		 LV107 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Equivalent dose:	 53  ±  2 Gy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Diameter:		 215 µm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MC runs error estim.:	 2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Age (conv.):		 149.73  ±  0.417  ka</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Age (new):		 130.642  ±  6.354  ka</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Dose rate (conv.):	 0.354  ±  0.012  Gy/ka</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Dose rate (onset):	 0.5  ±  0.02  Gy/ka</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Dose rate (final):	 0.361  ±  0.011  Gy/ka</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ------------------------------------------------ </span>
<span class="r-plt img"><img src="model_DoseRate-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    SAMP_NAME     K   K_X    T  T_X    U  U_X U238 U238_X U234_U238 U234_U238_X</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     LV107 0.073 0.004 0.67 0.02 0.79 0.07    0      0         0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    WCI WCI_X WCF WCF_X CC CC_X DIAM DIAM_X COSMIC COSMIC_X INTERNAL INTERNAL_X</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  10     2   5     5 60    2  215     35 0.0876   0.0044        0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ONSET ONSET_X FINISH FINISH_X DE DE_X AGE_CONV AGE_CONV_X     AGE AGE_X</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   120      10     40       10 53    2   149.73      0.417 130.642 6.354</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    DR_CONV DR_CONV_X DR_ONSET DR_ONSET_X DR_FINAL DR_FINAL_X n.MC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   0.354     0.012      0.5       0.02    0.361      0.011    2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Roger P. Nathan, Barbara Mauz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

